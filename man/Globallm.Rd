% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Globallm.R
\name{Globallm}
\alias{Globallm}
\title{Global testing procedure for testing functional-on-scalar linear models}
\usage{
Globallm(
  formula,
  dx = NULL,
  B = 1000L,
  method = c("residuals", "responses"),
  stat = c("Integral", "Max")
)
}
\arguments{
\item{formula}{An object of class \code{\link[stats:formula]{stats::formula}} (or one that can be
coerced to that class) specifying the model to be fitted in a symbolic
fashion. The output variable (left-hand side) of the formula can be either
a matrix of dimension \eqn{n \times J} containing the pointwise evaluations
of \eqn{n} functions on the \strong{same} grid of \eqn{J} points, or an object
of class \code{\link[fda:fd]{fda::fd}}.}

\item{dx}{A numeric value specifying the discretization step of the grid used
to evaluate functional data when it is provided as objects of class
\code{\link[fda:fd]{fda::fd}}. Defaults to \code{NULL}, in which case a default value of \code{0.01} is
used which corresponds to a grid of size \code{100L}. Unused if functional data
is provided in the form of matrices.}

\item{B}{An integer value specifying the number of iterations of the MC
algorithm to evaluate the p-value of the permutation tests. Defaults to
\code{1000L}.}

\item{method}{A string specifying the method used to calculate the p-value of
permutation tests. Choices are either \code{"residuals"} which performs
permutation of residuals under the reduced model according to the Freedman
and Lane scheme or \code{"responses"}, which performs permutation of the
responses, according to the Manly scheme. Defaults to \code{"residuals"}.}

\item{stat}{A string specifying the test statistic used for the global test.
Choices are either \code{"Integral"}, in which case the statistic is defined as
the integral of the F-test statistic over the domain, or \code{"Max"}, in which
case the statistic is defined as the maximum of the F-test statistic over
the domain. Defaults to  \code{"Integral"}.}
}
\value{
An object of class \code{IWTlm}. The function \code{summary} is used to
obtain and print a summary of the results. This object is a list containing
the following components:
\itemize{
\item \code{call}: Call of the function.
\item \code{design_matrix}: Design matrix of the linear model.
\item \code{unadjusted_pval_F}: Unadjusted p-value function of the F test.
\item \code{adjusted_pval_F}: Adjusted p-value function of the F test.
\item \code{unadjusted_pval_part}: Unadjusted p-value functions of the functional
t-tests on each covariate, separately (rows) on each domain point
(columns).
\item \code{adjusted_pval_part}: Adjusted p-values of the functional t-tests on each
covariate (rows) on each domain point (columns).
\item \code{Global_pval_F}: Global p-value of the overall test F.
\item \code{Global_pval_part}: Global p-value of t-test involving each covariate
separately.
\item \code{data.eval}: Evaluation of functional data.
\item \code{coeff.regr.eval}: Evaluation of the regression coefficients.
\item \code{fitted.eval}: Evaluation of the fitted values.
\item \code{residuals.eval}: Evaluation of the residuals.
\item \code{R2.eval}: Evaluation of the functional R-suared.
}
}
\description{
The function is used to fit and test functional linear models. It can be used
to carry out regression, and analysis of variance. It implements the global
testing procedure for testing the significance of the effects of scalar
covariates on a functional population.
}
\examples{
# Defining the covariates
temperature <- rbind(NASAtemp$milan, NASAtemp$paris)
groups <- c(rep(0, 22), rep(1, 22))

# Performing the IWT
Global.result <- Globallm(temperature ~ groups, B = 1000)
# Summary of the IWT results
summary(Global.result)

# Plot of the IWT results
layout(1)
plot(
  Global.result, 
  main = 'NASA data', 
  plot_adjpval = TRUE, 
  xlab = 'Day', 
  xrange = c(1, 365)
)

# All graphics on the same device
layout(matrix(1:6, nrow = 3, byrow = FALSE))
plot(
  Global.result, 
  main = 'NASA data', 
  plot_adjpval = TRUE, 
  xlab = 'Day', 
  xrange = c(1, 365)
)
}
\references{
Abramowicz, K., Pini, A., Schelin, L., Stamm, A., & Vantini, S. (2022).
â€œDomain selection and familywise error rate for functional data: A unified
framework. \emph{Biometrics} 79(2), 1119-1132.

D. Freedman and D. Lane (1983). A Nonstochastic Interpretation of Reported
Significance Levels. \emph{Journal of Business & Economic Statistics} 1(4),
292-298.

B. F. J. Manly (2006). Randomization, \emph{Bootstrap and Monte Carlo Methods
in Biology}. Vol. 70. CRC Press.
}
\seealso{
See \code{\link{summary.IWTlm}} for summaries and
\code{\link{plot.IWTlm}} for plotting the results. See
\code{\link{ITPlmbspline}} for a functional linear model test based on an
a-priori selected B-spline basis expansion. See also \code{\link{IWTaov}}
to fit and test a functional analysis of variance applying the IWT, and
\code{\link{IWT1}}, \code{\link{IWT2}} for one-population and
two-population tests.
}
